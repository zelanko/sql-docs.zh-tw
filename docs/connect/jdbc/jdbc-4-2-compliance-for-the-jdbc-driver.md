---
title: JDBC Driver 的 JDBC 4.2 合規性 |Microsoft Docs
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
ms.assetid: 36025ec0-3c72-4e68-8083-58b38e42d03b
author: MightyPen
ms.author: genemi
ms.openlocfilehash: 3a35c7592eb6e5b95d1dee4a953b98fcde12845b
ms.sourcegitcommit: b2464064c0566590e486a3aafae6d67ce2645cef
ms.translationtype: MTE75
ms.contentlocale: zh-TW
ms.lasthandoff: 07/15/2019
ms.locfileid: "67956398"
---
# <a name="jdbc-42-compliance-for-the-jdbc-driver"></a>適用於 JDBC 驅動程式的 JDBC 4.2 相容性

[!INCLUDE[Driver_JDBC_Download](../../includes/driver_jdbc_download.md)]

> [!NOTE]  
> 適用於 SQL Server 的 Microsoft JDBC 驅動程式 4.2 之前的版本，與 Java 資料庫連線 API 4.0 規格相容。 本節不適用於在 4.2 版之前的版本。  
  
 Microsoft JDBC Driver 4.2 for SQL Server 可使用下列 API 方法，支援 Java 資料庫連線 API 4.2 規格。  
  
## <a name="sqlserverstatement-class"></a>SQLServerStatement 類別
  
|新的方法|Description|值得注意的實作|  
|-----------------|-----------------|-------------------------------|  
|long[] executeLargeBatch()|執行批次，其中傳回的更新計數可能會很長。|如 java.sql.Statement 介面中所述實作。 如需詳細資料，請參閱 [java.sql.Statement](https://docs.oracle.com/javase/8/docs/api/java/sql/Statement.html#executeLargeBatch--)。|  
|long executeLargeUpdate(String sql)<br /><br /> long executeLargeUpdate(String sql, int autoGeneratedKeys)<br /><br /> long executeLargeUpdate(String sql, int[] columnIndexes)<br /><br /> executeLargeUpdate(String sql, String[] columnNames)|執行資料操作語言 (DML)/資料定義語言 (DDL)，其中傳回的更新計數可能會很長。 有 4 個新的 (多載) 方法來支援較長的更新計數。|如 java.sql.Statement 介面中所述實作。 如需詳細資料，請參閱 [java.sql.Statement](https://docs.oracle.com/javase/8/docs/api/java/sql/Statement.html#executeLargeBatch--)。|  
|long getLargeMaxRows()|擷取資料列的最大數目為長整數值，該結果集可以取得此數值。|SQL Server 只支援最大資料列的整數限制。 如需詳細資料，請參閱 [java.sql.Statement](https://docs.oracle.com/javase/8/docs/api/java/sql/Statement.html#executeLargeBatch--)。|  
|long getLargeUpdateCount()|擷取目前結果為長整數值，當做更新計數。|SQL Server 只支援最大資料列的整數限制。 如需詳細資料，請參閱 [java.sql.Statement](https://docs.oracle.com/javase/8/docs/api/java/sql/Statement.html#executeLargeBatch--)。|  
|void setLargeMaxRows(long max)|設定資料列的最大數目為長整數值，該結果集可以取得此數值。|SQL Server 只支援最大資料列的整數限制。 如果大於最大整數大小的值做為參數傳遞，這個方法就會擲回不受支援的例外狀況。 如需詳細資料，請參閱 [java.sql.Statement](https://docs.oracle.com/javase/8/docs/api/java/sql/Statement.html#executeLargeBatch--)。|  
  
## <a name="sqlservercallablestatement-class"></a>SQLServerCallableStatement 類別  
  
|新的方法|Description|值得注意的實作|  
|-----------------|-----------------|-------------------------------|  
|void registerOutParameter(int parameterIndex, SQLType sqlType)<br /><br /> void registerOutParameter(int parameterIndex, SQLType sqlType, int scale)<br /><br /> void registerOutParameter(int parameterIndex, SQLType sqlType, String typeName)<br /><br /> void registerOutParameter(String parameterName, SQLType sqlType)<br /><br /> void registerOutParameter(String parameterName, SQLType sqlType, int scale)<br /><br /> registerOutParameter(String parameterName, SQLType sqlType, String typeName)|註冊 OUT 參數。 有 6 個新的 (多載) 方法來支援新的 SQLType 介面。|如 java.sql.CallableStatement 介面中所述實作。 如需詳細資料，請參閱 [java.sql.CallableStatement](https://docs.oracle.com/javase/8/docs/api/java/sql/CallableStatement.html)。|  
|void setObject(String parameterName, Object x, SQLType targetSqlType)<br /><br /> void setObject(String parameterName, Object x, SQLType targetSqlType, int scaleOrLength)|設定具有指定物件的參數值。 有 2 個新的 (多載) 方法來支援新的 SQLType 介面。|如 java.sql.CallableStatement 介面中所述實作。 如需詳細資料，請參閱 [java.sql.CallableStatement](https://docs.oracle.com/javase/8/docs/api/java/sql/CallableStatement.html)。|  
  
## <a name="sqlserverpreparedstatement-class"></a>SQLServerPreparedStatement 類別
  
|新的方法|Description|值得注意的實作|  
|-----------------|-----------------|-------------------------------|  
|long executeLargeUpdate()|執行 DML/DDL 陳述式，並傳回較長的更新計數|如 java.sql.PreparedStatement 介面中所述實作。 如需詳細資料，請參閱 [java.sql.PreparedStatement](https://docs.oracle.com/javase/8/docs/api/java/sql/PreparedStatement.html)。|  
|void setObject(int parameterIndex, Object x, SQLType targetSqlType)<br /><br /> void setObject(int parameterIndex, Object x, SQLType targetSqlType, int scaleOrLength)|設定具有指定物件的參數值。 有 2 個新的 (多載) 方法來支援新的 SQLType 介面。|如 java.sql.PreparedStatement 介面中所述實作。 如需詳細資料，請參閱 [java.sql.PreparedStatement](https://docs.oracle.com/javase/8/docs/api/java/sql/PreparedStatement.html)。|  
  
## <a name="sqlserverdatabasemetadata-class"></a>SQLServerDatabaseMetaData 類別
  
|新的方法|Description|值得注意的實作|  
|-----------------|-----------------|-------------------------------|  
|long getMaxLogicalLobSize()|擷取這個資料庫對 LOB 邏輯大小所允許的位元組數目上限。|在 SQL Server，這個值是 2 ^31-1。 如需詳細資料，請參閱 [java.sql.DatabaseMetaData](https://docs.oracle.com/javase/8/docs/api/java/sql/DatabaseMetaData.html)。|  
|boolean supportsRefCursors()|擷取值，此值指出這個資料庫是否支援 REF CURSOR。|會傳回 false，因為 SQL Server 不支援 REF CURSOR。 如需詳細資料，請參閱 [java.sql.DatabaseMetaData](https://docs.oracle.com/javase/8/docs/api/java/sql/DatabaseMetaData.html)。|  
  
## <a name="sqlserverresultset-class"></a>SQLServerResultSet 類別
  
||||  
|-|-|-|  
|新的方法|Description|值得注意的實作|  
||使用物件值，更新指定的資料行。 有 4 個新的 (多載) 方法來支援新的 SQLType 介面。|如 java.sql.ResultSet 介面中所述實作。 如需詳細資料，請參閱 [java.sql.ResultSet](https://docs.oracle.com/javase/8/docs/api/java/sql/ResultSet.html)。|  
  
 Microsoft JDBC Driver 4.2 for SQL Server 可使用下列資料類型對應，支援 Java 資料庫連線 API 4.2 規格。  
  
|||  
|-|-|  
|新的資料類型對應|Description|  
|**Java 8 中的新 Java 類別：** <br /> <br /> LocalDate/LocalTime/LocalDateTime<br /><br /> OffsetTime/OffsetDateTime<br /><br /> **新的 JDBC 類型：**<br /><br /> TIME_WITH_TIMEZONE<br /><br /> TIMESTAMP_WITH_TIMEZONE<br /><br /> REF_CURSOR|在 SQL Server 中不支援 REF_CURSOR。 如果使用了此類型，則驅動程式會擲回 SQLFeatureNotSupportedException 例外狀況。 該驅動程式支援所有其他新的 Java 和 JDBC 類型對應，如 JDBC 4.2 規格中所指定。|  
