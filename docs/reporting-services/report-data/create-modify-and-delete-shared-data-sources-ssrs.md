---
title: 建立、修改及刪除共用資料來源 | Microsoft Docs
ms.date: 05/24/2018
ms.prod: reporting-services
ms.prod_service: reporting-services-native
ms.technology: report-data
ms.topic: conceptual
helpviewer_keywords:
- modifying data source properties
- shared data sources [Reporting Services]
- removing shared data sources
- roles [Reporting Services], shared data sources
- data sources [Reporting Services], shared
- data sources [Reporting Services], modifying properties
- deleting shared data sources
ms.assetid: 1e58c1c2-5ecf-4ce6-9d04-0a8acfba17be
author: maggiesMSFT
ms.author: maggies
ms.openlocfilehash: 3cb8f79b892b639e618143fd138920650fb5cfda
ms.sourcegitcommit: ff82f3260ff79ed860a7a58f54ff7f0594851e6b
ms.translationtype: HT
ms.contentlocale: zh-TW
ms.lasthandoff: 03/29/2020
ms.locfileid: "77081823"
---
# <a name="create-modify-and-delete-shared-data-sources-ssrs"></a>建立、修改及刪除共用資料來源 (SSRS)
  共用資料來源是一組資料來源連接屬性，可供多個報表、模型以及在 [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] 報表伺服器上執行的資料驅動訂閱參考。  共用資料來源提供一種簡單的方式，可用來管理通常會隨著時間而變更的資料來源屬性。 如果使用者帳戶或密碼變更，或者如果您將資料庫移到不同的伺服器，可以在一個地方更新連接資訊。  
  
 對於報表以及資料驅動訂閱而言，共用資料來源是選擇性的，但是對於報表模型而言，則是必要的。 如果您打算將報表模型用於隨選報表，您必須建立並維護一個共用資料來源項目，才能提供連接資訊給模型。  
  
 共用資料來源包含下列部分：  
  
|部分|描述|  
|----------|-----------------|  
|名稱|識別報表伺服器資料夾階層中之項目的名稱。|  
|描述|檢視資料夾的內容時，與入口網站中的項目一起顯示的描述。|  
|連線類型|與資料來源搭配使用的資料處理延伸模組。 您僅能使用在報表伺服器上部署的資料處理延伸模組。 如需 [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)] 隨附之資料處理延伸模組的詳細資訊，請參閱 [Reporting Services &#40;SSRS&#41; 支援的資料來源](../../reporting-services/report-data/data-sources-supported-by-reporting-services-ssrs.md)。|  
|連接字串|資料庫的連接字串。 如需詳細資訊以及檢視常用資料來源的連接字串範例，請參閱[建立資料連接字串 - 報表產生器 & SSRS](../../reporting-services/report-data/data-connections-data-sources-and-connection-strings-report-builder-and-ssrs.md)。|  
|認證類型|指定如何取得用於連接的認證，以及建立連接後是否要使用這些認證。 如需詳細資訊，請參閱 [指定報表資料來源的認證及連接資訊](../../reporting-services/report-data/specify-credential-and-connection-information-for-report-data-sources.md)。|  
  
 共用資料來源不包含用來擷取資料的查詢資訊。 查詢永遠會保留在報表定義中。  
  
## <a name="creating-and-modifying-shared-data-sources"></a>建立與刪除共用資料來源  
 若要建立共用資料來源或修改其屬性，您必須擁有報表伺服器的 [管理資料來源]  權限。 如果報表伺服器是在原生模式下執行，您可以使用入口網站來建立與設定共用資料來源。 如果報表伺服器是在 SharePoint 整合模式下執行，您可以使用 SharePoint 網站上的應用程式頁面。 如果是任意模式下的任何報表伺服器，您可以在「報表設計師」中建立共用資料來源，然後將其發行到目標伺服器上。  
  
 在報表伺服器上建立共用資料來源之後，您可以建立角色指派來控制其存取權、將其移動到不同的位置、重新命名它，或者在外部資料來源執行維護作業時離線以防進行報表處理。 如果您重新命名或移動共用資料來源項目至報表伺服器資料夾階層中的其他位置，所有參考共用資料來源的報表或訂閱，其相關路徑資訊會隨之更新。 如果您讓共用資料來源離線，所有報表、模型和訂閱都不會執行，直到您重新啟用資料來源為止。  
  
 如需在報表伺服器資料夾階層控制共用資料來源存取權的詳細資訊，請參閱 [保護共用資料來源項目的安全](../../reporting-services/security/secure-shared-data-source-items.md)。  
  
 **在報表設計師中建立共用資料來源**  
  
1.  在 [報表資料] 窗格的工具列上，按一下 **[新增]** ，然後按一下 **[資料來源]** 。 **[資料來源屬性]** 對話方塊隨即開啟。  
  
    > [!NOTE]  
    >  如果看不到 [報表資料] 窗格，請按一下 [檢視]  功能表上的 [報表資料]  。  
  
2.  在 **[名稱]** 文字方塊中，輸入資料來源的名稱或接受預設值。 資料來源名稱是在報表內部使用。 為了清楚起見，我們建議資料來源的名稱要包含連接字串中所指定的資料庫名稱。  
  
3.  請確認已選取 [使用共用資料來源參考]  ，然後執行下列動作。  
  
    1.  按一下 **[新增]** 。 在 [共用資料來源]  屬性對話方塊中，遵循步驟 2 和 3 來建立新的資料來源。  
  
    2.  [!INCLUDE[clickOK](../../includes/clickok-md.md)]  
  
         新的共用資料來源會出現在 [方案總管] 的 [共用資料來源] 資料夾中。  
  
4.  按一下 **[認證]** 。  
  
     指定用於這個資料來源的認證。 資料來源的擁有者會選擇支援的認證類型。  
  
 **在入口網站中建立共用資料來源**  
  
1.  在入口網站中，選取 [新增]   > [資料來源]  。 
  
4.  輸入項目的名稱。 名稱必須至少包含一個字元，而且開頭必須為字母。 它也可以包含特定符號，但不能包含空格或下列字元：; ? : \@ & = + , $ / * < > | " /。  
  
5.  選擇性地鍵入描述，以提供使用者連線的相關資訊。  
  
6.  在 [資料來源類型]  清單中，指定用來處理資料來源中之資料的資料處理延伸模組。  
  
7.  針對 [連接字串]  ，指定報表伺服器用於連線到資料來源的連接字串。 建議您不要在連接字串中指定認證。  
  
     下列範例將說明用以連線至本機 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] AdventureWorks2016 資料庫的連接字串：  
  
    ```  
    data source=<localservername>; initial catalog=AdventureWorks2016 
    ```  
  
8.  針對 **[使用下列方式連接]** ，指定報表執行時要如何取得認證：  
  
    -   如果您要提示使用者輸入登入名稱和密碼，請按一下 **[執行報表的使用者所提供的認證]** 。 若要使用使用者所輸入的認證作為 Windows 認證，請按一下 [連線到資料來源時作為 Windows 認證]  。 如果使用者名稱和密碼是資料庫認證，請勿選取此選項。  
  
    -   如果您打算將資料來源當作具有資料來源擁有者所管理之預存認證的共用資料來源，或是在支援訂閱或其他已排程之作業 (例如自動化報表記錄產生) 的報表中使用資料來源，請按一下 [安全地儲存在報表伺服器中的認證]  。 如果資料庫伺服器支援模擬或委派，您就可以選取 **[連接到資料來源後，模擬已驗證的使用者]** 。  
  
    -   對於存取報表的使用者提供的認證，若要讓報表伺服器將認證傳送給主控外部資料來源的伺服器，請按一下 **[Windows 整合式安全性]** 。 在此情況下，不會提示使用者輸入使用者名稱或密碼。  
  
    -   如果資料來源沒有使用認證 (例如，如果資料來源是從檔案系統存取的 XML 檔)，請按一下 [不需要認證]  。 只有當這種認證類型適用於資料來源時，您才應該指定此認證類型。 如果您針對需要驗證的資料來源選取此選項，連接將會失敗。 如果您選取此選項，請務必設定自動執行帳戶，以便在使用者認證無法使用時，允許報表伺服器連接至其他電腦以擷取資料或檔案。  
  
         如需設定認證的詳細資訊，請參閱 [指定報表資料來源的認證及連接資訊](../../reporting-services/report-data/specify-credential-and-connection-information-for-report-data-sources.md)。 如需自動執行帳戶的詳細資訊，請參閱[設定自動執行帳戶 &#40;SSRS 設定管理員&#41;](../../reporting-services/install-windows/configure-the-unattended-execution-account-ssrs-configuration-manager.md)。  
  
9. 按一下 [測試連線]  按鈕，驗證資料來源設定。  
  
    > [!NOTE]  
    >  [測試連接] 按鈕不支援 XML 資料來源類型。  
  
10. 按一下 [檔案] &gt; [新增] &gt; [專案]   
  
 **在入口網站中修改共用資料來源**  
  
1.  在入口網站中，巡覽至共用資料來源。  
  
2.  選取共用資料來源右上角的省略符號 (...) > [管理]  。   

    [屬性]  頁面隨即開啟。
  
3.  修改資料來源，然後按一下 [套用]  。  
  
## <a name="deleting-shared-data-sources"></a>刪除共用資料來源  
 您可以利用從報表伺服器刪除任何項目的相同方式，刪除共用資料來源。  
  
 **若要刪除共用資料來源**  
  
1. 在入口網站中，巡覽至共用資料來源。  
  
2.  選取共用資料來源右上角的省略符號 (...) > [管理]  。    
    [屬性]  頁面隨即開啟。
  
3. 按一下 [刪除]  ，然後按一下 [確定]  。  
  
刪除共用資料來源會停用使用共用資料來源的所有報表、模型或資料驅動訂閱。 如果沒有資料來源連接資訊，這些項目就無法再執行 若要啟動這些項目，您必須開啟每個項目，並執行下列動作：  
  
-   若是參考共用資料來源的報表和資料驅動訂閱，您可以在報表屬性或訂閱中指定資料來源連接資訊，或者選取其中包含您要使用之值的新共用資料來源。  
  
-   若是模型或使用該模型的「報表產生器」報表，您必須指定一個新的共用資料來源。 這些模型僅能透過共用資料來源取得資料來源連接資訊。  
  
 刪除共用資料來源時，沒有「復原」作業。 不過，如果您不小心刪除了共用資料來源，可以使用相同的屬性值來建立一個新的共用資料來源。 您必須開啟每個報表、模型和資料驅動訂閱，才能在使用它的項目中重建共用資料來源，但是，只要資料來源屬性與之前的資料來源屬性相同，報表、模型和訂閱就會如先前般運作。  
  
## <a name="importing-shared-data-sources"></a>匯入共用資料來源  

**若要在報表設計師中匯入現有的資料來源**  
  
1.  在方案總管中，以滑鼠右鍵按一下報表伺服器專案中的 [共用資料來源]  資料夾，然後按一下 [加入現有項目]  。 [新增現有項目]  對話方塊隨即開啟。  
  
2.  巡覽至現有的報表定義共用資料來源 (rds) 檔案，然後按一下 [開啟]  。  
  
3.  [!INCLUDE[clickOK](../../includes/clickok-md.md)]  
  
## <a name="shared-data-sources-in-sharepoint"></a>SharePoint 中的共用資料來源  
 當您從 SharePoint 文件庫執行報表時，可以在報表內部或連結到報表的外部檔案中定義連接資訊。 如果連接資訊內嵌於報表中，它就稱為自訂資料來源。 如果連接資訊定義於外部檔案中，它就稱為共用資料來源。 外部檔案可以是報表伺服器資料來源 (.rsds) 檔案或 Office 資料連線 (.odc) 檔案。  
  
 .rsds 檔類似 .rds 檔，但結構描述不同。 若要建立 .rsds 檔，您可以將 .rds 檔從報表設計師或模型設計師中發行到 SharePoint 文件庫 (便會根據原始 .rds 檔建立新的 .rsds 檔)。 或者，您可以在 SharePoint 網站的文件庫中建立新檔案。  
  
 當您建立或發行共用資料來源之後，就可以編輯連接屬性，而且如果已經不需要，還可以刪除該檔案。 刪除共用資料來源之前，您應該先判斷是否有報表和報表模型使用此共用資料來源。 您可以檢視參考到共用資料來源的相依項目來判斷。  
  
 雖然相依項目清單會告訴您是否有項目參考到共用資料來源，但是並不會告訴您此項目目前是否使用中。 若要判斷共用資料來源或模型目前是否使用中，您可以檢閱報表伺服器電腦上的記錄檔。 如果您無法存取這些記錄檔，或者這些檔案沒有包含所需的資訊，請考慮在您判斷報表的實際狀態時，將報表移至無法存取的資料夾。  
  
 **若要建立共用資料來源 (.rsds) 檔案 (SharePoint 2010)**  
  
1.  按一下文件庫功能區上的 [文件]  索引標籤。  
  
2.  在 [新增文件]  功能表上，按一下 [報表資料來源]   
  
    > [!NOTE]  
    >  如果您沒有在功能表上看見 [報表資料來源]  項目，表示報表資料來源內容類型尚未啟用。 如需詳細資訊，請參閱 [將 Reporting Services 內容類型加入至 SharePoint 文件庫](../../reporting-services/report-server-sharepoint/add-reporting-services-content-types-to-a-sharepoint-library.md)。  
  
3.  在 [名稱]  中，輸入 .rsds 檔的描述性名稱。  
  
4.  在 [資料來源類型]  的清單中，選取資料來源的類型。 如需詳細資訊，請參閱 [Reporting Services &#40;SSRS&#41; 支援的資料來源](../../reporting-services/report-data/data-sources-supported-by-reporting-services-ssrs.md)。  
  
5.  在 [連接字串]  中，指定資料來源的指標以及其他建立外部資料來源連線必要的任何設定。 您所使用的資料來源類型會決定連接字串的語法。 如需詳細資訊和範例，請參閱[建立資料連接字串 - 報表產生器 & SSRS](../../reporting-services/report-data/data-connections-data-sources-and-connection-strings-report-builder-and-ssrs.md)。  
  
6.  在 [認證]  中，指定報表伺服器取得認證來存取外部資料來源的方式。 認證可以針對自動報表處理而儲存、提示、整合或設定。  
  
    -   如果您想要使用開啟報表之使用者的認證來存取資料，請選取 [Windows 驗證 (整合式)]  。 如果 SharePoint 網站或伺服陣列使用表單驗證或透過受信任帳戶連接到報表伺服器，請勿選取這個選項。 如果您想要排程這個報表的訂閱或資料處理，請勿選取這個選項。 在針對網域啟用 Kerberos 驗證時，或者資料來源與報表伺服器是在同一部電腦上時，此選項具有最佳的效能。 如果未啟用 Kerberos 驗證，Windows 認證只能傳遞至一部其他電腦。 這表示，如果外部資料來源位於另一部需要其他連接的電腦上，您就會收到錯誤而非所預期的資料。  
  
    -   如果您希望使用者在每次執行報表時輸入自己的認證，請選取 [提示認證]  。 如果您想要排程這個報表的訂閱或資料處理，請勿選取這個選項。  
  
    -   如果您想要使用單一認證集來存取這個資料，請選取 [預存認證]  。 認證會先經過加密，然後再儲存。 您可以選取決定預存認證之驗證方式的選項。 如果預存認證屬於 Windows 使用者帳戶，請選取 [當做 Windows 認證使用]。 如果您想在資料庫伺服器上設定執行內容，請選取 [設定執行內容到這個帳戶]  。 針對 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 資料庫，此選項會設定 SETUSER 函數。 如需詳細資訊，請參閱 [SETUSER &#40;Transact-SQL&#41;](../../t-sql/statements/setuser-transact-sql.md)。  
  
    -   如果您想要在連接字串中指定認證，或是想要使用報表伺服器上設定的最低權限帳戶來執行報表，請選取 [不需要認證]  。 如果這個帳戶並未在報表伺服器上設定，系統就會提示使用者輸入認證，而且您針對該報表定義的所有排程作業將不會執行。  
  
7.  如果您想要讓資料來源成為使用中，請選取 [啟用此資料來源]  。 如果資料來源已設定，但是非使用中，當使用者嘗試使用以資料來源為基礎的報表時，他們就會看見錯誤訊息。  
  
8.  按一下 [測試連線]  按鈕，驗證資料來源設定。  
  
    > [!NOTE]  
    >  [測試連接] 按鈕不支援 XML 資料來源類型。  
  
9. 按一下 [確定]  ，儲存建立的共用資料來源。  
  
 **刪除共用資料來源 (.rsds) 檔案**  
  
1.  開啟包含 .rsds 檔案的文件庫。  
  
2.  指向共用資料來源。  
  
3.  按一下即可顯示向下箭頭，然後按一下 [刪除]  。  
  
 如果您不小心刪除了想要保留的共用資料來源，可以建立包含相同連接資訊的新共用資料來源。 在您重新建立共用資料來源之後，就必須開啟使用該資料來源的每個報表和模型，然後選取共用資料來源。 新的共用資料來源項目的名稱、認證或連接字串語法可以與之前刪除的資料來源不同。 只要連接解析成相同的資料來源，資料來源屬性可能會與原始值不同。  
  
 刪除報表模型時，請特別小心。 如果您刪除模型，就不能再於報表產生器中，開啟和修改以該模型為基礎的任何報表。 如果您不慎刪除了現有報表所使用的模型，就必須重新產生該模型，重新建立並儲存使用該模型的任何報表，然後重新指定想要使用的任何模型項目安全性。 您不能只是重新產生模型，然後將它附加到現有的報表。  
  
## <a name="dependent-items"></a>相依項目  
 若要檢視使用資料來源之報表和模型的清單，開啟共用資料來源的 [相依項目] 頁面。 當您在入口網站或 SharePoint 應用程式頁面中開啟資料來源時，您可以存取此頁面。 請注意，[相依項目] 頁面中不會顯示資料驅動訂閱。 如果共用資料來源是由訂閱所使用，訂閱將不會出現在相依項目清單中。  
  
 **檢視 SharePoint 中的相依項目**  
  
1.  開啟包含 .rsds 檔案的文件庫。  
  
2.  指向共用資料來源。  
  
3.  按一下即可顯示向下箭頭，然後選取 [檢視相依項目]  。  
  
     若為報表模型，相依項目的清單就會顯示在報表產生器中建立的報表。 若為共用資料來源，相依項目清單可能會同時包括報表和報表模型。  
  
## <a name="see-also"></a>另請參閱  
 [建立資料連接字串 - 報表產生器 & SSRS](../../reporting-services/report-data/data-connections-data-sources-and-connection-strings-report-builder-and-ssrs.md)   
 [管理報表資料來源](../../reporting-services/report-data/manage-report-data-sources.md)   
 [設定編頁報表的資料來源屬性](../../reporting-services/report-data/configure-data-source-properties-for-a-report-report-manager.md)  
  
  
