---
title: 使用程序的時機 |Microsoft Docs
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- SQL statements [ODBC], procedures
- procedures [ODBC], about procedures
ms.assetid: 7dc9e327-dd54-4b10-9f66-9ef5c074f122
author: MightyPen
ms.author: genemi
manager: craigg
ms.openlocfilehash: 82e71e6849902eb2f02423560c534056112a139a
ms.sourcegitcommit: 3026c22b7fba19059a769ea5f367c4f51efaf286
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 06/15/2019
ms.locfileid: "63208390"
---
# <a name="when-to-use-procedures"></a>程序的使用時機
有許多優點，使用程序，所有基礎是以使用程序移動 SQL 陳述式從資料來源的應用程式。 剩下的應用程式中是互通的程序呼叫。 這些優點包括：  
  
-   **效能**程序通常是執行 SQL 陳述式的最快方式。 例如備妥的執行，此陳述式編譯並執行兩個不同的步驟。 不同於備妥的執行程序會執行只能在執行階段。 它們會在不同的時間進行編譯。  
  
-   **商務規則**A*商務規則*所在公司經營業務方式的相關規則。 比方說，只有標題為 銷售人員的人可能會允許加入新的銷售訂單。 放置程序中的這些規則，可讓個別公司自訂垂直應用程式的重寫應用程式而不需要修改應用程式程式碼呼叫的程序。 例如，訂單輸入應用程式可能會呼叫此程序**InsertOrder**使用固定數目的參數; 方式**InsertOrder**實作可以改變公司公司。  
  
-   **可取代性**密切相關放置程序中的商務規則是程序，可以不需要重新編譯應用程式已取代的事實。 如果商務規則變更公司已購買並安裝應用程式之後，公司可以變更包含該規則的程序。 從應用程式的觀點來看，沒有任何變更;它仍然會呼叫特定的程序，才能完成特定工作。  
  
-   **DBMS 專屬 SQL**程序提供應用程式以利用特定 DBMS 的 SQL，仍可互通的方式。 比方說，DBMS 在 SQL 中支援的流程控制陳述式上的程序可能會攔截並上不支援的流程控制陳述式的 DBMS 的程序可能只會傳回錯誤時，從錯誤復原。  
  
-   **程序存活交易**某些資料來源，在認可或回復交易時，會刪除所有備妥的陳述式的存取方案的連接上。 將 SQL 陳述式放在程序，會永久儲存在資料來源，陳述式會存留在交易。 程序存留是否在已備妥，部分備妥，或未準備的狀態的 DBMS 特定。  
  
-   **區隔開發**可以個別開發程序，從應用程式的其餘部分。 在大型公司，這可能會提供用來在進一步利用高度專業程式設計人員的技能。 換句話說，應用程式設計人員可以撰寫使用者介面程式碼和資料庫程式設計人員可以撰寫程序。  
  
 程序通常用於垂直和自訂應用程式。 這些應用程式通常會執行固定的工作，您也可以在其中硬式編碼程序呼叫。 例如，訂單輸入應用程式可能會呼叫程序**InsertOrder**， **DeleteOrder**， **UpdateOrder**，以及**GetOrders**.  
  
 實在沒什麼理由，從一般的應用程式呼叫程序。 在特定的應用程式的內容中執行的工作通常會撰寫程序，因此有 一般應用程式沒有使用。 例如，試算表的呼叫沒有理由**InsertOrder**剛剛提到的程序。 此外，泛型應用程式不應該建構程序在執行階段使用者提供更快速的陳述式執行;不只是要低於備妥或已直接執行，這可能也需要特定 DBMS 的 SQL 陳述式。  
  
 這個例外狀況是應用程式開發環境，通常會提供方法讓程式設計師建置 SQL 陳述式來執行程序，可能會提供方法讓程式設計人員進行測試程序。 這類環境呼叫**SQLProcedures**清單中可用的程序並**SQLProcedureColumns**列出輸入、 輸入/輸出和輸出參數，程序會傳回值和資料行程序所建立的任何結果集。 不過，這類程序必須事先在上開發每個資料來源;這樣做需要特定 DBMS 的 SQL 陳述式。  
  
 有三個主要的缺點，使用程序。 首先，必須撰寫程序，並針對每個應用程式是要執行的 DBMS 編譯。 雖然這不是問題的自訂應用程式，它可能會大幅增加開發和設計用來執行以 Dbms 的數字的垂直應用程式的維護時間。  
  
 第二個缺點是，有許多 Dbms 不支援程序。 同樣地，這是最有可能是設計用來執行以 Dbms 的數字的垂直應用程式的問題。 若要判斷是否支援程序，應用程式會呼叫**SQLGetInfo** SQL_PROCEDURES 選項。  
  
 第三個缺點，也就是特別適用於應用程式開發環境，是 ODBC 不會定義標準的文法建立程序。 也就是說，雖然應用程式可以 interoperably 呼叫程序，但無法建立它們 interoperably。
