---
title: "間隔常值 |Microsoft 文件"
ms.custom: 
ms.date: 01/19/2017
ms.prod: sql-non-specified
ms.prod_service: drivers
ms.service: 
ms.component: odbc
ms.reviewer: 
ms.suite: sql
ms.technology: drivers
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- data types [ODBC], interval data types
- interval literals [ODBC]
- interval data type [ODBC], literals
ms.assetid: f9e6c3c7-4f98-483f-89d8-ebc5680f021b
caps.latest.revision: "6"
author: MightyPen
ms.author: genemi
manager: jhubbard
ms.workload: Inactive
ms.openlocfilehash: 0ee22a6f808dd1b97d0d865229c78cbf26808fba
ms.sourcegitcommit: cc71f1027884462c359effb898390c8d97eaa414
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 12/21/2017
---
# <a name="interval-literals"></a>間隔常值
ODBC 需要所有的驅動程式支援所有 C 間隔資料型別 SQL_CHAR 或 SQL_VARCHAR 資料類型的轉換。 如果基礎資料來源不支援間隔資料類型，不過，驅動程式必須知道為了支援這些轉換的正確格式 SQL_CHAR 欄位中的值。 同樣地，ODBC 需要應該有任何的 ODBC C 類型可轉換成 SQL_CHAR 或 SQL_VARCHAR，讓驅動程式必須知道何種格式字元的欄位中儲存的間隔。 本章節描述間隔常值，用以驗證 SQL_CHAR 欄位，或從 C 間隔資料類型轉換期間需要的驅動程式寫入器的語法。  
  
> [!NOTE]  
>  區段中顯示間隔的常值的完整 BNF 語法[間隔常值的語法](../../../odbc/reference/appendixes/interval-literal-syntax.md)附錄 c: SQL 文法中。  
  
 若要將間隔常值傳遞做為 SQL 陳述式的一部分，逸出子句語法定義間隔常值。 如需詳細資訊，請參閱[日期、 時間和時間戳記常值](../../../odbc/reference/develop-app/date-time-and-timestamp-literals.md)。  
  
 格式是常值的間隔：  
  
```  
INTERVAL[<sign>] 'value' <interval qualifier>  
```  
  
 在 [間隔] 表示字元常值是間隔。 符號可以是加號或減號。它超出間隔的字串，並為選擇性。  
  
 間隔限定詞可以是單一的日期時間欄位或表單中兩個日期時間欄位所組成： \<*前置欄位*> TO \<*尾端欄位*>。  
  
-   當間隔所組成的單一欄位中時，單一欄位可以是可能會伴隨選擇性的開頭有效位數，括號括住的非第二個欄位。 單一日期時間欄位也可以是選擇性的開頭有效位數、 選擇性的小數秒數有效位數，以括弧括住，或兩者都可附帶的第二個欄位。 如果開頭的有效位數，小數秒數有效位數的秒數欄位，會以逗號分隔。 如果小數秒數有效位數的秒欄位，它也必須擁有開頭的有效位數。  
  
-   間隔開頭和尾端欄位所組成，開頭的欄位時的非第二個欄位，可能會伴隨開頭括號中的欄位有效位數的間隔。 尾端欄位可以是非第二個欄位或可能伴隨著括號括住間隔小數秒有效位數的第二個欄位。  
  
 中的時間間隔字串*值*括在單引號中。 它可以是年-月常值或日期時間常值。 在字串的格式*值*取決於下列規則：  
  
-   字串包含每個欄位所隱含的十進位值\<*間隔**限定詞*>。  
  
-   如果間隔有效位數包含年份和月份的欄位，這些欄位的值是會以負號分隔。  
  
-   如果間隔有效位數包含天和小時欄位，這些欄位的值會以空格分隔。  
  
-   如果間隔有效位數會包含欄位小時和較低的順序欄位 （分和秒），這些欄位的值會以分隔。  
  
-   如果間隔有效位數包含第二個欄位的明示或默示的秒數有效位數為非零之前第一個數字的小數部分的第二個, 字元是句號。  
  
-   沒有欄位可以是兩個以上的數字，long，除了：  
  
    -   前置字元欄位的值可以是只要明示或默示間隔開頭有效位數。  
  
    -   第二個欄位的分數部分可以是只要明示或默示的秒數有效位數。  
  
    -   尾端的欄位會依西曆的一般條件約束。 (請參閱[西曆的條件約束](../../../odbc/reference/appendixes/constraints-of-the-gregorian-calendar.md)。)  
  
 下表列出 ODBC 逸出子句中包含一段時間的有效間隔常值的範例。 逸出子句的語法如下所示：  
  
> [!NOTE]  
>  *{間隔登間隔字串間隔限定詞}*  
  
|常值的逸出子句|指定間隔|  
|---------------------------|------------------------|  
|{間隔 '326' YEAR(4)}|指定 326 年的間隔。 間隔開頭有效位數為 4。|  
|{間隔 '326' MONTH(3)}|指定 326 幾個月的間隔。 間隔開頭有效位數是 3。|  
|{間隔 '3261' DAY(4)}|指定 3261 天的間隔。 間隔開頭有效位數為 4。|  
|{間隔 '163' HOUR(3)}|指定 163 天的間隔。 間隔開頭有效位數是 3。|  
|{間隔 '163' MINUTE(3)}|指定 163 分鐘的間隔。 間隔開頭有效位數是 3。|  
|{間隔 '223.16' SECOND(3,2)}|指定 223.16 秒的間隔。 間隔開頭有效位數為 3，而秒數有效位數為 2。|  
|{間隔 ' 163-11' 月份的 YEAR(3)}|指定 163 年 11 月的間隔。 間隔開頭有效位數是 3。|  
|{間隔 ' 163 12' 小時 DAY(3)}|指定 163 天又 12 小時的間隔。 間隔開頭有效位數是 3。|  
|{間隔 '163 12:39' 分鐘 DAY(3)}|指定 163 天，12 小時和 39 分鐘的間隔。 間隔開頭有效位數是 3。|  
|{間隔至 SECOND(3) '163 12:39:59.163' DAY(3)}|指定 163 天、 12 小時、 39 分鐘的時間，和 59.163 秒的間隔。 間隔開頭有效位數是 3，而秒數有效位數是 3。|  
|{間隔 '163:39' 分鐘 HOUR(3)}|指定 163 小時 39 分鐘的間隔。 間隔開頭有效位數是 3。|  
|{間隔 '163:39:59.163' SECOND(4) 的 HOUR(3)}|指定 163 小時，39 分鐘和 59.163 秒的間隔。 間隔開頭有效位數為 3，而秒數有效位數為 4。|  
|{間隔 '163:59.163' SECOND(5) 的 MINUTE(3)}|指定 163 分鐘 59.163 秒的間隔。 間隔開頭有效位數為 3，，而且秒數有效位數為 5。|  
|{間隔的第二個 '16 23:39:56.23' DAY}|指定減去 16 天，23 小時，39 分鐘和 56.23 秒的間隔。 隱含的開頭有效位數為 2，並隱含的秒數有效位數為 6。|  
  
 下表列出無效的間隔常值的範例：  
  
|常值的逸出子句|原因無效的原因|  
|---------------------------|------------------------|  
|{間隔 '163' HOUR(2)}|間隔開頭有效位數為 2，但 [前置] 欄位的值是 163。|  
|{間隔 '223.16' SECOND(2,2)}<br /><br /> {間隔 '223.16' SECOND(3,1)}|在第一個範例中，開頭的有效位數為太小，而在第二個範例中，秒數有效位數為太小。|  
|{間隔 '223.16' 第二個}<br /><br /> {間隔 '223' YEAR}|因為未指定的開頭有效位數，則預設為 2，這是保留指定的常值太小。|  
|{間隔 '22.1234567' 第二個}|秒數有效位數是未指定，因此它會預設為 6。 常值的小數點後具有 7 個位數。|  
|{間隔 ' 163-13' 月份的 YEAR(3)}<br /><br /> {INTERVAL ' 163} 65' DAY(3) 小時的時間<br /><br /> {間隔為分鐘 '163 62:39' DAY(3)}<br /><br /> {間隔至 SECOND(3) '163 12:125:59.163' DAY(3)}<br /><br /> {間隔 '163:144' 分鐘 HOUR(3)}<br /><br /> {間隔 '163:567:234.163' SECOND(4) 的 HOUR(3)}<br /><br /> {間隔 '163:591.163' SECOND(5) 的 MINUTE(3)}|尾端欄位並未遵循西曆的規則。|
