---
title: 索引鍵集資料指標 |Microsoft Docs
ms.prod: sql
ms.prod_service: connectivity
ms.technology: connectivity
ms.custom: ''
ms.date: 01/19/2017
ms.reviewer: ''
ms.topic: conceptual
helpviewer_keywords:
- Keyset cursors [ADO]
- cursors [ADO], Keyset
ms.assetid: 14b51b17-6fd9-4146-af45-ca4b0fe6d48a
author: MightyPen
ms.author: genemi
ms.openlocfilehash: c7a12d1579af407bca77c9fa61d660a84a09f04e
ms.sourcegitcommit: e042272a38fb646df05152c676e5cbeae3f9cd13
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/27/2020
ms.locfileid: "67924900"
---
# <a name="keyset-cursors"></a>索引鍵集資料指標
索引鍵集資料指標可在靜態和動態資料指標之間提供功能，以偵測變更。 如同靜態資料指標，它不一定會偵測結果集的成員資格和順序變更。 如同動態資料指標，它會偵測結果集中的資料列值變更。  
  
 索引鍵集驅動資料指標是由稱為索引鍵集的一組唯一識別碼 (索引鍵) 所控制。 索引鍵是從結果集中唯一識別資料列的一組資料行建立的。 索引鍵集是一組取自由查詢陳述式傳回之所有資料列的索引鍵值。  
  
 使用索引鍵集驅動資料指標，會在資料指標中為每個資料列建置和保留一個索引鍵，並儲存在用戶端工作站或伺服器上。 當您存取每個資料列時，會使用此預存金鑰從資料來源擷取目前的資料值。 在索引鍵集驅動資料指標中，當完整擴展索引鍵集時，結果集的成員資格會遭到凍結。 之後，在重新開啟之前，都不會在結果集中新增或更新受影響的成員資格。  
  
 資料值的變更（由索引鍵集擁有者或其他進程所建立）可在使用者滾動整個結果集時看見。 只有在關閉並重新開啟資料指標之後，才能看見其他處理序在資料指標外部執行的插入。 在結果集結尾可看見從資料指標內部執行的插入。  
  
 當索引鍵集驅動資料指標嘗試取出已刪除的資料列時，該資料列會在結果集中顯示為「洞」。 索引鍵集中存在資料列的索引鍵，但結果集中不再有此資料列。 如果資料列中的索引鍵值已更新，則會將資料列視為已刪除然後插入，因此這類資料列也會顯示為結果集中的洞。 雖然索引鍵集驅動資料指標永遠可以偵測其他進程所刪除的資料列，但它可以選擇性地移除其本身刪除之資料列的索引鍵。 執行此動作的索引鍵集驅動資料指標無法偵測自己的刪除，因為已移除辨識項。  
  
 索引鍵資料行的更新，其運作方式就像是舊索引鍵的刪除，然後插入新的索引鍵。 如果不是透過資料指標進行更新，就看不到新的索引鍵值。 如果是透過資料指標進行更新，則會在結果集的結尾看到新的索引鍵值。  
  
 索引鍵集驅動的資料指標有一種變化，稱為索引鍵集驅動的標準資料指標。 在索引鍵集驅動的標準資料指標中，結果集的資料列成員資格和資料列的順序會在資料指標開啟時固定，但會顯示由資料指標擁有者所做的變更，以及其他進程所做的認可變更。 如果變更 disqualifies 成員資格的資料列，或影響資料列的順序，則資料列不會消失或移動，除非資料指標已關閉並重新開啟。 插入的資料不會出現，但現有資料的變更會在提取資料列時顯示。  
  
 索引鍵集導向的資料指標很容易正確使用，因為資料變更的敏感度取決於許多不同的情況，如上所述。 不過，如果您的應用程式不在意並行更新，可以透過程式設計方式處理不正確的索引鍵，而且必須直接存取特定的索引資料列，而索引鍵集驅動的資料指標可能適用于您。 使用**AdOpenKeyset CursorTypeEnum** ，表示您想要在 ADO 中使用索引鍵集資料指標。  
  
## <a name="see-also"></a>另請參閱  
 [順向資料指標](../../../ado/guide/data/forward-only-cursors.md)   
 [靜態資料指標](../../../ado/guide/data/static-cursors.md)   
 [動態資料指標](../../../ado/guide/data/dynamic-cursors.md)
