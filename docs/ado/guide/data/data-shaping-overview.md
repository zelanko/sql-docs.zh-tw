---
description: 資料成形概觀
title: 資料成形總覽 |Microsoft Docs
ms.prod: sql
ms.prod_service: connectivity
ms.technology: connectivity
ms.custom: ''
ms.date: 01/19/2017
ms.reviewer: ''
ms.topic: conceptual
helpviewer_keywords:
- data shaping [ADO], overview
ms.assetid: 4cb5fd29-4e56-46ac-ae48-a6771c321c0c
author: rothja
ms.author: jroth
ms.openlocfilehash: 5d0f6502ccfa58b28f0faeaf10b2670a42759a2a
ms.sourcegitcommit: e700497f962e4c2274df16d9e651059b42ff1a10
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/17/2020
ms.locfileid: "88453550"
---
# <a name="data-shaping-overview"></a>資料成形概觀
*資料成形* 表示在查詢中建立兩個或多個邏輯實體之間的階層式關聯性。 階層可以在一個記錄 [集](../../../ado/reference/ado-api/recordset-object-ado.md)記錄之間的父子式關聯性中看到，以及一或多筆記錄 (也稱為另一個 **記錄集**的章節) 。 在父子式關聯性中，父 **記錄集** 包含子 **記錄集**。 這類階層式關聯性的範例是客戶和訂單。 針對資料庫中的每個客戶，可以有零或多個訂單。 階層式關聯性可以是遞迴的，也就是說，您可以在子記錄中嵌套孫記錄。 在主體中，階層式記錄可以嵌套到任何深度。 在實務上，ADO 會將遞迴限制為最多512的 **記錄集**。  
  
 一般而言，圖形化 **記錄集** 的資料行可以包含資料提供者的資料，例如 Microsoft® SQL Server、另一個 **記錄集**的參考、從 **記錄集**之單一資料列的計算衍生的值，或是整個 **記錄集**之資料行上的作業所衍生的值。 資料行也可以是新的製造和空白的。  
  
 當您抓取包含另一個 **記錄集**參考的資料行值時，ADO 會自動傳回參考所表示的實際 **記錄集** 。 **記錄集**的參考實際上是子系子集的參考，稱為*章節*。 單一父系可以參考一個以上的子 **記錄集**。  
  
 資料成形的 ADO 支援可讓您查詢資料來源，並傳回 **記錄集** ，其中 (的父) 記錄代表 (的子) **記錄集**。 在客戶訂單案例中，您可以使用資料成形來取得客戶的資訊，以及每位客戶在單一查詢中所放置的訂單。 結果 **集的記錄** 集也稱為成形的 **記錄集**。  
  
 此外，ADO 中的資料成形還可讓您建立新的 **記錄集** 物件，而不使用基礎資料來源，方法是使用 **new** 關鍵字來描述父系和子 **記錄集**的欄位。 然後，新的 **記錄集** 物件可以填入資料並持續儲存。 開發人員也可以執行各種計算或匯總 (例如，[ **SUM**]、[ **AVG**] 和 [ **MAX** ]) 子欄位。 資料成形也可以藉由將子記錄中的記錄分組，以從子**記錄集**建立父記錄**集**，並將子系中每個群組的一個資料列放在父系中。  
  
 一般 SQL 可讓您使用 **聯結** 語法來取出資料，但是這樣可能會沒有效率且更難使用，因為在指定的父子式關聯性傳回的每一筆記錄中，會重複出現重複的父資料。 資料成形可將父記錄 **集中** 的單一父記錄與子記錄 **集中**的多個子記錄產生關聯，以避免 **聯結**的冗余。 大部分的人都發現父子式 **記錄集** 程式設計模型比單一 **記錄集聯結** 模型更自然且更容易使用。
