---
title: 建立預測（基本資料採礦教學課程） |Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: a8410ed2-bb98-4d51-a9eb-b239be1201c2
author: minewiskan
ms.author: owend
manager: kfile
ms.openlocfilehash: 456aec6c6b9d0d1a5d0ee1d9949507a37577130c
ms.sourcegitcommit: b87d36c46b39af8b929ad94ec707dee8800950f5
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 02/08/2020
ms.locfileid: "67597516"
---
# <a name="creating-predictions-basic-data-mining-tutorial"></a>建立預測 (基本資料採礦教學課程)
  在測試過您的採礦模型的精確度並決定您對結果感到滿意之後，您就可以在資料採礦設計工具的 [**採礦模型預測**] 索引標籤上使用預測查詢產生器來產生預測。  
  
 預測查詢產生器有三個檢視。 您可以使用 [**設計**] 和 [**查詢**] 視圖來建立及檢查查詢。 接著，您可以執行查詢，並在**結果**視圖中查看結果。  
  
 所有的預測查詢都是使用 DMX，也就是資料採礦延伸模組 (DMX) 語言的縮寫。 DMX 的語法與 T-SQL 的語法相似，但用於對資料採礦物件的查詢。 雖然 DMX 語法並不複雜，但使用此類的查詢產生器或適用于 Office 的[SQL Server 資料採礦增益集](../../2014/analysis-services/data-mining/sql-server-data-mining-add-ins-for-office.md)，可讓您更輕鬆地選取輸入和建立運算式，因此強烈建議您瞭解基本概念。  
  
## <a name="creating-the-query"></a>建立查詢  
 建立預測查詢的第一個步驟是，選取採礦模型和輸入資料表。  
  
#### <a name="to-select-a-model-and-input-table"></a>若要選取模型和輸入資料表  
  
1.  在資料採礦設計師的 [**採礦模型預測**] 索引標籤上，按一下 [**採礦模型**] 方塊中的 [**選取模型**]。  
  
2.  在 [**選取模型**] 對話方塊中，流覽樹狀目錄至**目標郵寄**結構，展開結構，選取`TM_Decision_Tree`，然後按一下 **[確定]**。  
  
3.  在 [**選取輸入資料表**] 方塊中，按一下 [**選取案例資料表**]。  
  
4.  在 [**選取資料表**] 對話方塊的 [**資料來源**] 清單中，選取 [資料來源[!INCLUDE[ssAWDWsp](../includes/ssawdwsp-md.md)]] 視圖。  
  
5.  在 [**資料表/視圖名稱**] 中，選取 [ **ProspectiveBuyer （dbo）** ] 資料表，然後按一下 **[確定]**。  
  
     `ProspectiveBuyer`資料表最類似于**vTargetMail**案例資料表。  
  
## <a name="mapping-the-columns"></a>對應資料行  
 選好輸入資料表之後，「預測查詢產生器」會根據資料行的名稱，在採礦模型和輸入資料表之間建立預設的對應。 此結構中至少必須有一個資料行符合外部資料中的資料行。  
  
> [!IMPORTANT]  
>  您用來判斷模型精確度的資料必須包含可對應至可預測資料行的資料行。 如果這類資料行不存在，您可以建立包含空值的資料行，但是其資料類型必須與預測的資料行相同。  
  
#### <a name="to-map-the-inputs-to-the-model"></a>將輸入對應至模型  
  
1.  以滑鼠右鍵按一下將 [**採礦模型**] 視窗連接到 [**選取輸入資料表**] 視窗的線條，然後選取 [**修改連接**]。  
  
     請注意，並非每一個資料行都會對應。 我們會加入數個**資料表資料行**的對應。 另外還會依據目前的日期資料行產生新的生日資料行，讓資料行更好比對。  
  
2.  在****[ `Bike Buyer`資料表資料行] 底下，按一下資料格，然後從下拉式清單中選取 [ProspectiveBuyer 未知]。  
  
     這會將可預測的資料行 [Bike Buyer] 對應到輸入資料表資料行。  
  
3.  按一下 [確定]  。  
  
4.  在**方案總管**中，以滑鼠右鍵按一下 [**目標郵寄**資料來源] 視圖，然後選取 [**視圖設計**工具]。  
  
5.  以滑鼠右鍵按一下資料表 ProspectiveBuyer，然後選取 [**新增] [命名計算**]。  
  
6.  在 [**建立命名計算**] 對話方塊的 [資料**行名稱**] `calcAge`中，輸入。  
  
7.  在 [**描述**] 中，輸入**根據出生日期計算存留期**。  
  
8.  在 [**運算式**] 方塊中`DATEDIFF(YYYY,[BirthDate],getdate())` ，輸入，然後按一下 **[確定]**。  
  
     由於輸入資料表沒有對應到模型中的 [ **age** ] 資料行，因此您可以使用此運算式來計算輸入資料表中 [出生日期] 資料行的客戶年齡。 因為**年齡**已識別為預測自行車購買的最具影響力資料行，所以它必須同時存在於模型和輸入資料表中。  
  
9. 在資料採礦設計工具中，選取 [**採礦模型預測**] 索引標籤，然後重新開啟 [**修改連接**] 視窗。  
  
10. 在 [**資料表資料行**] 底下，按一下 [ **Age** ] 資料格，然後從下拉式清單中選取 [ProspectiveBuyer calcAge]。  
  
    > [!WARNING]  
    >  如果您未在清單中看見資料行，可能必須重新整理設計師中所載入資料來源檢視的定義。 若要這麼做，請**在 [檔案] 功能表中**選取 [**全部儲存**]，然後在設計工具中關閉並重新開啟專案。  
  
11. 按一下 [確定]  。  
  
## <a name="designing-the-prediction-query"></a>設計預測查詢  
  
1.  [**採礦模型預測**] 索引標籤工具列上的第一個按鈕是切換到 [**設計檢視]/[切換到結果檢視/切換至查詢檢視**] 按鈕。 按一下此按鈕上的向下箭號，然後選取 [**設計**]。  
  
2.  在 [**採礦模型預測**] 索引標籤上的方格中，按一下 [**來源**] 資料行中第一個空白資料列內的資料格，然後選取 [**預測函數**]。  
  
3.  在 [**預測函數**] 資料列的 [**欄位**] 資料`PredictProbability`行中，選取 []。  
  
     在相同資料列的 [**別名**] 資料行中，輸入**result 的**機率。  
  
4.  從上方的 [**採礦模型**] 視窗中，選取 [自行車買方]，並將其拖曳至 [**準則/引數**] 資料格中。  
  
     當您讓 go 時，[TM_Decision_Tree]。[自行車購買者] 出現在 [**準則/引數**] 資料格中。  
  
     這會指定 `PredictProbability` 函數的目的地資料行。 如需函式的詳細資訊，請參閱[資料採礦擴充功能 &#40;DMX&#41;](/sql/dmx/data-mining-extensions-dmx-function-reference)函式參考。  
  
5.  按一下 [**來源**] 資料行中的下一個空白資料列，然後選取 [ **TM_Decision_Tree**的採礦模型]。  
  
6.  在資料`TM_Decision_Tree`列的 [**欄位**] 資料行中`Bike Buyer`，選取 []。  
  
7.  在資料`TM_Decision_Tree`列的 [**準則/引數**] 資料行`=1`中，輸入。  
  
8.  按一下 [**來源**] 資料行中的下一個空白資料列，然後選取 [ **ProspectiveBuyer 資料表**]。  
  
9. 在資料`ProspectiveBuyer`列的 [**欄位**] 資料行中，選取 [ **ProspectiveBuyerKey**]。  
  
     這會在預測查詢中加入唯一識別碼，供您辨識可能會購買和可能不會購買自行車的人。  
  
10. 將其他五個資料列加入至方格中。 針對每個資料列，選取 [ **ProspectiveBuyer 資料表**] 做為**來源**，然後在**欄位**資料格中新增下列資料行：  
  
    -   calcAge  
  
    -   姓氏  
  
    -   名字  
  
    -   AddressLine1  
  
    -   AddressLine2  
  
 最後，執行此查詢並瀏覽結果。  
  
 **預測查詢**產生器也包含下列控制項：  
  
-   **顯示**核取方塊  
  
     讓您可以移除查詢中的子句，而不必從設計師將其刪除。 當您使用複雜的查詢而想要保留語法時，這樣就不必複製 DMX 再貼入視窗，所以相當實用。  
  
-   **小組**  
  
     在所選該行的開頭插入左括號，或在目前該行的結尾插入右括號。  
  
-   **和/或**  
  
     在目前的函數或資料行的正後方插入 `AND` 運算子或 `OR` 運算子。  
  
#### <a name="to-run-the-query-and-view-results"></a>若要執行查詢並檢視結果  
  
1.  在 [**採礦模型預測**] 索引標籤中，選取 [**結果**] 按鈕。  
  
2.  當執行此查詢並顯示結果之後，您可以檢閱結果。  
  
     [**採礦模型預測**] 索引標籤會顯示可能是自行車購買者之潛在客戶的連絡人資訊。 [**結果的**機率] 資料行指出預測正確的機率。 您可以利用這些結果來判斷哪些潛在的客戶應該成為郵寄目標。  
  
3.  此時，您可以儲存結果。 您有三個選項：  
  
    -   以滑鼠右鍵按一下結果中的資料列，然後選取 [**複製**]，只將該值（和資料行標題）儲存到剪貼簿。  
  
    -   以滑鼠右鍵按一下結果中的任何資料列，然後選取 [**全部複製**]，將整個結果集（包括資料行標題）複製到剪貼簿。  
  
    -   按一下 [**儲存查詢結果**]，將結果直接儲存到資料庫，如下所示：  
  
        1.  在 [**儲存資料採礦查詢結果**] 對話方塊中，選取資料來源，或定義新的資料來源。  
  
        2.  輸入將包含查詢結果之資料表的名稱。  
  
        3.  使用 [**加入至 DSV**] 選項來建立資料表，並將它加入至現有的資料來源 view。 如果您想要在相同的資料來源視圖中保留模型的所有相關資料表（例如定型資料、預測來源資料和查詢結果），這會很有用。  
  
        4.  使用 [**如果存在則覆寫**] 選項，以使用最新的結果來更新現有的資料表。  
  
             如果您已將任何資料行加入至預測查詢、變更預測查詢中任何資料行的名稱或資料類型，或者已針對目的地資料表執行任何 ALTER 陳述式，就必須使用此選項來覆寫資料表。  
  
             此外，如果有多個資料行具有相同的名稱（例如，預設資料行名稱**運算式**），您就必須為名稱重複的資料行建立別名，否則當設計師嘗試將結果儲存到 SQL Server 時，就會引發錯誤。 原因是 SQL Server 不允許多個資料行具有相同的名稱。  
  
             如需詳細資訊，請參閱 &#40;的 [ [&#41;的模型預測視圖儲存資料採礦查詢結果] 對話方塊](../../2014/analysis-services/save-data-mining-query-result-dialog-box-mining-model-prediction-view.md)。  
  
## <a name="next-task-in-lesson"></a>本課程的下一項工作  
 [在結構資料上使用鑽取 &#40;基本資料採礦教學課程&#41;](../../2014/tutorials/using-drillthrough-on-structure-data-basic-data-mining-tutorial.md)  
  
## <a name="see-also"></a>另請參閱  
 [使用預測查詢產生器來建立預測查詢](../../2014/analysis-services/data-mining/create-a-prediction-query-using-the-prediction-query-builder.md)  
  
  
