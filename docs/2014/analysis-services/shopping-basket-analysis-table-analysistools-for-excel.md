---
title: 購物籃分析（適用于 Excel 的資料表 AnalysisTools） |Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
helpviewer_keywords:
- shopping basket analysis
- mining model, association
- Table Analysis tools
- association [data mining]
- market basket analysis
ms.assetid: ba40cf43-f286-49ad-8316-70f5b11f1dae
author: minewiskan
ms.author: owend
manager: craigg
ms.openlocfilehash: 3dadc054a3f9927c09e9e236044dd5ddee7f3a9a
ms.sourcegitcommit: b87d36c46b39af8b929ad94ec707dee8800950f5
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 02/08/2020
ms.locfileid: "66068683"
---
# <a name="shopping-basket-analysis-table-analysistools-for-excel"></a>購物籃分析 (適用於 Excel 的資料表分析工具)
  ![購物籃工具](media/tat-shopbskt.gif "購物籃工具")  
  
 [**購物籃分析**] 工具可協助`associations`您在資料中尋找。 關聯可以告訴您通常會同時購買的項目。 在資料採礦中，這項技術是稱為「*購物籃分析*」的知名方法，用來分析非常大型資料集中客戶的購買行為。 商人可能會利用這項資訊，為客戶製造建議的相關產品，並將這些產品放在網頁上、目錄中或貨架上非常接近的地方來進行促銷。  
  
 若要使用購物籃分析，您要分析的項目必須透過交易識別碼產生關聯。 例如，如果要分析透過網站收到的所有訂單，每張訂單都會有一個與一或多個購買項目相關聯的訂單識別碼或交易識別碼。  
  
 當 wizard 完成分析資料時，它會建立兩個新的工作表、**購物籃專案群組**和**購物籃規則**。  
  
 [**購物籃專案群組**] 工作表包含經常在交易中一起出現的專案清單。 這些常見的分組稱為*專案集*。 此工作表也包含統計*資料，例如**支援*和增益，以協助您瞭解專案集的重要性。 如果有價格資訊，此工作表也可以針對所有相關的項目建立值的總和，以提供交易總值的指標。  
  
 您可以在報表中篩選與排序資料行。 例如，您可能只想要查看具有2個或更多產品的專案集，或依**平均購物籃值**排序專案集。  
  
 [**購物籃規則**] 工作表會使用衍生自分析的統計資料，來建立與專案相關的規則。 例如，規則可能是客戶購買產品 A 時，很有可能購買產品 B。這些規則可以用來建立建議。 每個規則都有支援的統計資料來協助您評估規則的潛在強度，讓您可以只在規則超出特定機率臨界值時才提出建議。  
  
## <a name="using-the-shopping-basket-analysis-tool"></a>使用購物籃分析工具  
  
1.  開啟包含正確資料的 Excel 資料表。 在範例活頁簿中，按一下 [關聯] 工作表。  
  
2.  按一下 [**購物籃分析**]。  
  
3.  在 [**購物籃分析**] 對話方塊中，選擇包含交易識別碼的資料行，然後選擇包含您想要分析之專案或產品的資料行。  
  
4.  您可以選擇地加入包含產品值的資料行。  
  
5.  按一下 [**高級**] 以開啟 [**高級參數設定**] 對話方塊。 增加 [**最低支援**] 的值，以減少分組為專案集的產品數目。 增加**最小規則**機率，以篩選出非常常見的專案集。  
  
### <a name="requirements"></a>需求  
 若要使用 [**購物籃分析**] 工具，您的資料必須儲存在 Excel 資料表中，而且必須包含下欄欄位：  
  
-   包含代表交易之唯一識別碼的資料行。 只要識別碼的值在每個資料列中是唯一的，該識別碼可以是數值或文字。  
  
-   包含要分析之項目或產品的資料行。  
  
-   代表每個項目之價格或值的選擇性數值資料行。 此資料行用於彙總每個產品所屬之項目集的值，而且可以協助您了解某些交易的總值。  
  
## <a name="how-items-are-associated"></a>項目產生關聯的方式  
 您所分析的個別項目必須透過代表案例、交易或地點的特定識別碼進行分組。 因此，您要選擇此交易識別碼資料行做為識別碼，而不是選擇客戶識別碼或產品識別碼。  
  
 當此工具檢查每筆交易內的產品時，會針對所找出之項目的每種組合建立項目集。 例如，如果客戶在單次造訪時購買三個項目，則有 7 種可能的項目集：每個產品各自獨立為一個群組、兩兩產品組成一個群組，以及全部三個產品組合成一個群組。  
  
> [!NOTE]  
>  您可以篩選出包含單一項目的項目集，但是此工具需要分析這些項目集才能為資料集產生有意義的統計資料。  
  
 每個項目集的支援會以購買項目集之客戶的數目計算。 在剛才敘述的範例中，如果只有一個客戶購買 3 個項目，在 7 種可能的項目集中，每個項目集的支援值都是 1。 當客戶數目增加時，以及當可能的組合數增加時，就可能要花更長時間來處理報表。 不過，有些項目集可能有非常小的支援。 因此，您可能將每個項目集中的項目數限制為 3 個 (含) 以下，以縮短產生報表所花的時間。 一般而言，項目集越大，擁有的支援越少，因此，取捨是可以接受的。  
  
## <a name="specifying-minimum-support-and-rule-probability"></a>指定最小支援與規則機率  
 當您的資料集越變越大時，可能項目群組與規則的數目可能會變成過多。 但是，您可以控制工具所輸出之結果的數目，而僅將重點放在最有價值的項目集與規則。 您可以在 [**購物籃] [高級參數] 對話方塊**中設定這些選項。  
  
### <a name="minimum-support"></a>最小支援  
 [*最小支援*] 表示必須包含特定專案集的交易數目，才會將其視為重要。 例如，除非已經在至少 10 個交易中購買某個項目集，否則您可能不會有興趣。 有兩種方式可以控制專案集重要性的臨界值，而且兩者都使用**最小支援**參數。  
  
 **作為絕對值：** 輸入代表包含目標專案之交易計數的數位。 例如，如果您輸入 10，出現在至少 10 個購物籃中的任何項目集都會包含在結果中。  
  
 **以百分比表示：** 輸入代表整個專案集集合百分比的數位。 例如，如果您指定 10，系統會計算所有項目集，而且鎖定為目標的項目集必須至少顯示為項目集總數的 10%。 如果您有非常大的資料集，使用百分比 (而非計數) 可以協助您將重點放在最重要的項目群組上。  
  
> [!NOTE]  
>  請記住，項目集的數目與資料中交易的數目不同。 每筆交易都可以包含多個項目集，但是，多數項目集在資料集中會重複出現數次。  
  
### <a name="rule-probability-and-rule-importance"></a>規則機率和規則重要性  
 規則的機率描述規則的結果有多少發生的可能性。 規則機率是透過支援規則之項目集頻率來計算的。 如果項目集很少發生，則機率比較低。  
  
 但是，機率高的規則不一定實用。 它們可能表示經常購買的項目集，因此需要額外促銷。 重要性是設計來測量規則的效益。 有時候，規則的機率相當高，但重要性低，這是因為預測不提供新的資訊。 例如，如果每個項目集包含屬性的特定狀態，則預測該狀態的規則只是一般規則，即使機率很高也一樣。  
  
 您應該試驗這些設定來查看不同的結果，並判斷哪個設定會產生最有趣的規則。  
  
## <a name="understanding-the-reports"></a>了解報表  
 [**購物籃分析**] 工具會建立兩個互補的報表。 第一個報告（標題為**分析期間所識別的重要專案群組**）提供了所有已找到的專案集清單。 您可以使用 Microsoft Excel 中的新資料表工具來排序、篩選與瀏覽資料。  
  
 第二份報表標題為「**購物籃規則**」，告訴您可以根據第一份報告中所列的專案集來做出哪種推斷。 項目集的清單在瀏覽和了解資料時比較實用，而規則的清單則在進行預測與提出建議時比較實用。  
  
### <a name="shopping-basket-item-groups-report"></a>購物籃項目群組報表  
 此報表包含資料集中找出之所有可能項目組合的清單。 例如，如果您的事務資料包含訂單，則 [**購物籃分析**] 工具會計算個別專案的排序次數，然後計算該專案與其他專案的所有組合。  
  
 此報表會列出在增益順序中找出的項目集。 增益是告訴您項目集重要性的一種分數。  
  
|報表中的資料行|提供的資訊|  
|----------------------|-----------------------|  
|項目的群組|列出項目集或項目的組合。|  
|群組大小|項目集中的項目數計數。 您可以篩選此欄位，僅查看項目的配對、單一項目等等。|  
|支援|產生此種組合之案例數目的計數。 您可以排序此資料行來查看最常見的項目集。|  
|平均值|僅在這個項目集中，項目值除以支援的總和。 您可以排序及篩選這個資料行，以鎖定不同價格範圍的產品。|  
|購物籃平均價值|在包含此項目集的訂單中，所有項目值除以支援的總和。 與項目集的平均值配對時，這個統計資料非常有趣。|  
|增益|代表此項目集對於完整資料集有趣程度的分數。 先取得兩個同時發生之項目的機率，然後除以兩個單獨出現之項目的機率，就可以計算出增益。 因此，如果項目之間有強烈的關聯，增益分數就會比較高。|  
  
### <a name="shopping-basket-rules-report"></a>購物籃規則報表  
 此報表包含一組透過分析找出之項目集而建立的規則。 例如，如果您的交易資料顯示產品 A 和 B 通常會被一起購買，[購物籃分析] 工具會建立一個規則，假設 B 存在，就會預測 A，反之亦然。  
  
 每個規則都與支援資料所衍生的機率相關聯。 這些機率在提出建議時相當實用。 例如，您可能只想根據現有的資料，查看至少有 50% 正確機會的規則。  
  
 此報表會列出在增益順序中找出的項目集。 增益是告訴您項目集重要性的一種分數。  
  
|報表中的資料行|提供的資訊|  
|----------------------|-----------------------|  
|現有的項目|列出提出建議時所需的項目。<br /><br /> 在資料採礦中，這些專案稱為「關聯規則」的*左邊*。|  
|預測的項目|列出要建議的項目。<br /><br /> 在資料採礦中，這些專案稱為「關聯規則」的*右側*。|  
|機率|顯示此規則正確的機率。|  
|支援|表示現有的資料中，針對此規則提供證據之案例的數目。|  
|規則值|如果您為購物籃中的項目提供一個值，此資料行會假設項目的成本來計算預測的價值。|  
|增益|表示第一個資料行之項目與第二個資料行之項目間的關聯強度。 也稱為*重要性*。<br /><br /> 增益為 0 時，表示沒有關聯。 正值表示第一個資料行中的項目會預測第二個資料行中的項目。 數字越大，關聯越強。|  
  
## <a name="related-tools"></a>相關工具  
 適用於 Excel 的資料採礦用戶端是一個獨立的增益集，它提供更進階的資料採礦功能，也包含執行關聯分析的精靈。 如需詳細資訊，請參閱[關聯 Wizard &#40;適用于 Excel&#41;的資料採礦用戶端](associate-wizard-data-mining-client-for-excel.md)。  
  
 如需有關執行此分析所使用之演算法的詳細資訊，請參閱《SQL Server 線上叢書》中的＜Microsoft 分析關聯演算法＞主題。  
  
## <a name="see-also"></a>另請參閱  
 [適用於 Excel 的資料表分析工具](table-analysis-tools-for-excel.md)  
  
  
